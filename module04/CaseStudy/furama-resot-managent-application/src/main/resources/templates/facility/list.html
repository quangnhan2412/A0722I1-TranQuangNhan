<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="/home :: header">
    <title>Facility List</title>

</head>
<body>

<div th:replace="/home :: head"></div>
<div th:replace="/home :: navbar"></div>
<div class="row" style="background: #48D1CC">
    <div class="col-4">
        <p>
            <a class="btn btn-success" th:href="@{/facility/create}">
                Add new Facility
            </a>
        </p>
    </div>
    <div class="col-3"></div>
    <div class="col-5">

        <form th:action="@{/facility/search}">
            <div class="row-search">
                <input type="text" th:value="${searchAll}" class="form-control rounded " name="searchAll" placeholder="search All" aria-label="Search"
                       aria-describedby="search-addon" style="width: 405px"/>
                <button type="submit" class="btn btn-info" style="width: 405px">Search</button>
            </div>
        </form>
    </div>
</div>

</div>
<div class="notify">
    <div th:if="${success}">
        <h3 th:text="${success}" style="color: blue"></h3>
    </div>
</div>
<form th:action="@{/facility/deleteAll}" method="get">
    <div>
        <table class="table table-striped table-bordered" id="facilities">
            <thead>
            <tr class="bg-success">
                <th><input type="checkbox" id="delete-all-idx"/></th>
                <td>ID</td>
                <td>Name</td>
                <td>Area</td>
                <td>Cost</td>
                <td>Max People</td>
                <td>Rent Type</td>
                <td>Facility Type</td>
                <td>Standard Room</td>
                <td>Action</td>

            </tr>
            </thead>
            <tbody>
            <tr th:each="row,rowStat : ${facilityList}" th:object="${row}">
                <td><input  type="checkbox" th:value="*{id}"  th:name="delete-idx" class="delete-all">
                    <!--                <input type="hidden"  th:value="*{name}" id="delAll" >-->
                </td>
                <td th:text="${row.id}"></td>
                <td th:text="${row.name}"></td>
                <td th:text="${row.getArea()}"></td>
                <td th:text="${row.getCost()}"></td>
                <td th:text="${row.getMaxPeople()}"></td>
                <td th:text="${row.rentTypes.name}"></td>
                <td th:text="${row.facilityTypes.name}"></td>
                <td th:text="${row.standardRoom}"></td>
                <td><a class="btn btn-success" th:href="@{/facility/edit/{id}(id=${row.id})}">Update</a>
                    <button type="button" class="btn btn-danger"  th:attr="data-name=${row.name}, data-id=${row.id}"
                            data-toggle="modal" data-target="#exampleModal">
                        Delete
                    </button>
                    <a class="btn btn-primary" th:href="@{/facility/view/{id}(id=${row.id})}">View</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <!-- Button trigger modal -->
        <button type="button" class="btn btn-danger"  data-toggle="modal" data-target="#exampleDeleteAll">
            Delete All
        </button>
    <!--Modal del all-->
    <div class="modal fade" id="exampleDeleteAll" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleLabel">Delete All</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Bạn sẽ xoá những người này?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                    <button type="submit" class="btn btn-primary" >Đồng ý</button>
<!--                    <a type="submit" class="btn btn-primary" >Đồng ý</a>-->
                </div>
            </div>
        </div>
    </div>
</form>
<!--phân trang-->
<div style="text-align: center;">
    <span>
    <a class="btn btn-primary" th:if="${facilityList.hasPrevious()}" th:href="@{/facility/list(page=${facilityList.number - 1})}">
        Previous
    </a>
</span>

    <span th:each="pageNo : ${#numbers.sequence(0,facilityList.totalPages  - 1) }">
        <a class="btn btn-primary" th:href="@{/facility/list(page= ${pageNo})}" th:text="${pageNo}"></a>
    </span>
    <span>
    <a class="btn btn-primary" th:if="${facilityList.hasNext()}" th:href="@{/facility/list(page=${facilityList.number + 1})}">
        Next
    </a>
</span>
</div>

<!-- Modal Delete -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Delete Facility</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form th:action="@{/facility/delete}" method="get">
                    <div class="modal-body">
                        <input type="hidden" th:name="ids" th:id="id-in-modal" >
                        <p> Bạn có muốn xóa : <strong id="name-in-modal"></strong></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                        <button type="submit" class="btn btn-primary">Đồng ý</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div th:replace="/home :: footer"></div>
<script>
    $(document).ready(function (){
        $("#delete-all-idx").click(function () {
            if ($(this).prop("checked")) {
                $(".delete-all").prop("checked", true);
            } else {
                $(".delete-all").prop("checked", false);
            }
        })
    });
    // function objDelete() {
    //     let id = document.getElementById("dataIdBtn").getAttribute("data-id");
    //     let name = document.getElementById("dataIdBtn").getAttribute("data-name");
    //     document.getElementById("id-in-modal").value = id;
    //     document.getElementById("name-in-modal").innerText = name;
    // }

        $('#exampleModal').on('show.bs.modal', function (event) {
            let button = $(event.relatedTarget) // Button that triggered the modal
            let id = button.data('id') // Extract info from data-* attributes
            let name = button.data('name')
            // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
            // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
            let modal = $(this)
            modal.find('#id-in-modal').val(id)
            modal.find('#name-in-modal').html(name)
        });


</script>
</body>
</html>
